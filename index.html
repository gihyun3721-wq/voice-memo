<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="theme-color" content="#000000">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="보이스 메모">
<title>보이스 메모</title>
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon-192.png">
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

  :root {
    --bg: #000;
    --surface: #1c1c1e;
    --surface2: #2c2c2e;
    --text: #fff;
    --sub: #636366;
    --accent: #f5a623;
    --red: #ff3b30;
    --safe-top: env(safe-area-inset-top, 0px);
    --safe-bottom: env(safe-area-inset-bottom, 0px);
  }

  html, body {
    height: 100%;
    background: var(--bg);
    color: var(--text);
    font-family: -apple-system, 'Helvetica Neue', sans-serif;
    overflow: hidden;
  }

  .app {
    display: flex;
    flex-direction: column;
    height: 100%;
    padding-top: var(--safe-top);
    padding-bottom: var(--safe-bottom);
  }



  /* ── Header ── */
  .app-header {
    padding: 10px 20px 8px;
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    flex-shrink: 0;
  }
  .app-title { font-size: 34px; font-weight: 700; letter-spacing: -0.5px; }
  .header-btn { background: var(--surface2); border: none; color: var(--accent); font-size: 14px; font-weight: 500; padding: 6px 14px; border-radius: 20px; cursor: pointer; }

  /* ── Search ── */
  .search-bar { margin: 0 20px 10px; background: var(--surface); border-radius: 12px; padding: 9px 14px; display: flex; align-items: center; gap: 8px; flex-shrink: 0; }
  .search-placeholder { color: var(--sub); font-size: 15px; }

  .section-label { padding: 0 20px 8px; font-size: 13px; font-weight: 600; color: var(--sub); text-transform: uppercase; letter-spacing: 0.5px; flex-shrink: 0; }

  /* ── Scrollable Content ── */
  .content {
    flex: 1;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    padding-bottom: 120px;
  }

  /* ── Player Panel ── */
  .player-panel {
    background: var(--surface);
    margin: 0 16px 2px;
    border-radius: 14px;
    padding: 20px 18px;
    display: none;
  }
  .player-panel.visible { display: block; }
  .player-title { font-size: 19px; font-weight: 700; color: var(--text); text-align: center; margin-bottom: 3px; letter-spacing: -0.3px; }
  .player-date { font-size: 13px; color: var(--sub); text-align: center; margin-bottom: 20px; }

  .waveform-container { position: relative; height: 56px; display: flex; align-items: center; gap: 2px; overflow: hidden; margin-bottom: 6px; cursor: pointer; }
  .waveform-bar { flex: 1; background: var(--surface2); border-radius: 2px; transition: background 0.2s; }
  .waveform-bar.played { background: var(--accent); }
  .playhead { position: absolute; top: 0; bottom: 0; width: 2px; background: var(--accent); border-radius: 2px; pointer-events: none; }

  .time-row { display: flex; justify-content: space-between; margin-bottom: 16px; }
  .time-current, .time-total { font-size: 12px; color: var(--sub); font-weight: 500; font-variant-numeric: tabular-nums; }

  .player-controls { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
  .ctrl-btn { background: none; border: none; color: var(--text); cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 4px; }
  .ctrl-btn-label { font-size: 10px; color: var(--sub); font-weight: 500; }
  .play-btn { width: 60px; height: 60px; background: var(--accent); border-radius: 50%; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 16px rgba(245,166,35,0.4); transition: transform 0.1s; }
  .play-btn:active { transform: scale(0.92); }
  .play-icon { width: 0; height: 0; border-style: solid; border-width: 10px 0 10px 17px; border-color: transparent transparent transparent #000; margin-left: 3px; }
  .pause-icon { display: flex; gap: 5px; }
  .pause-icon span { width: 4px; height: 20px; background: #000; border-radius: 2px; display: block; }

  .options-row { display: flex; justify-content: space-between; align-items: center; padding-top: 12px; border-top: 0.5px solid var(--surface2); }
  .opt-btn { background: var(--surface2); border: none; color: var(--text); font-size: 13px; font-weight: 600; padding: 6px 12px; border-radius: 8px; cursor: pointer; display: flex; align-items: center; gap: 4px; }
  .opt-btn.speed { color: var(--accent); }

  /* ── Memo List ── */
  .memo-list { padding: 0 16px; display: flex; flex-direction: column; gap: 1px; }
  .memo-item { background: var(--surface); padding: 14px 16px; cursor: pointer; position: relative; transition: background 0.1s; }
  .memo-item:first-child { border-radius: 12px 12px 0 0; }
  .memo-item:last-child { border-radius: 0 0 12px 12px; }
  .memo-item:only-child { border-radius: 12px; }
  .memo-item::after { content: ''; position: absolute; bottom: 0; left: 16px; right: 0; height: 0.5px; background: var(--surface2); }
  .memo-item:last-child::after { display: none; }
  .memo-item:active { background: var(--surface2); }
  .memo-title-row { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 4px; }
  .memo-name { font-size: 17px; font-weight: 600; color: var(--text); flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
  .memo-duration { font-size: 14px; color: var(--sub); margin-left: 8px; white-space: nowrap; }
  .memo-meta { display: flex; align-items: center; gap: 8px; }
  .memo-date { font-size: 13px; color: var(--sub); }
  .memo-preview { font-size: 13px; color: var(--sub); flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

  /* ── Bottom Record Bar ── */
  .bottom-bar {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 16px 20px;
    padding-bottom: calc(16px + var(--safe-bottom));
    display: flex;
    justify-content: center;
    align-items: center;
    background: linear-gradient(to top, #000 50%, transparent);
    z-index: 10;
  }
  .record-btn-outer { width: 72px; height: 72px; border-radius: 50%; border: 4px solid var(--red); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: transform 0.1s; }
  .record-btn-outer:active { transform: scale(0.94); }
  .record-btn-inner { width: 52px; height: 52px; background: var(--red); border-radius: 50%; transition: border-radius 0.2s, width 0.2s, height 0.2s; }

  @keyframes fadeUp { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>
<div class="app">

  <!-- Header -->
  <div class="app-header">
    <div class="app-title">보이스 메모</div>
    <button class="header-btn">편집</button>
  </div>

  <!-- Search -->
  <div class="search-bar">
    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#636366" stroke-width="2.5"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
    <span class="search-placeholder">검색</span>
  </div>

  <div class="section-label">나의 기기</div>

  <!-- Scrollable content -->
  <div class="content">

    <!-- Player Panel -->
    <div class="player-panel" id="playerPanel">
      <div class="player-title">엄마와 마지막 통화</div>
      <div class="player-date">2022. 11. 9. · 3:47</div>

      <div class="waveform-container" id="waveform" onclick="seekWaveform(event)"></div>

      <div class="time-row">
        <span class="time-current" id="timeCurrent">0:00</span>
        <span class="time-total">-3:47</span>
      </div>

      <div class="player-controls">
        <button class="ctrl-btn" onclick="skip(-15)">
          <svg width="30" height="30" viewBox="0 0 24 24" fill="white">
            <path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/>
          </svg>
          <span class="ctrl-btn-label">15초 전</span>
        </button>

        <button class="play-btn" id="playBtn" onclick="togglePlay()">
          <div class="play-icon" id="playIconEl"></div>
        </button>

        <button class="ctrl-btn" onclick="skip(15)">
          <svg width="30" height="30" viewBox="0 0 24 24" fill="white">
            <path d="M12 5V1l5 5-5 5V7c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6h2c0 4.42-3.58 8-8 8s-8-3.58-8-8 3.58-8 8-8z"/>
          </svg>
          <span class="ctrl-btn-label">15초 후</span>
        </button>
      </div>

      <div class="options-row">
        <button class="opt-btn speed" onclick="cycleSpeed()"><span id="speedLabel">1×</span></button>
        <button class="opt-btn">
          <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>
          공유
        </button>
        <button class="opt-btn">
          <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14H6L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/></svg>
          삭제
        </button>
      </div>
    </div>

    <!-- Memo List -->
    <div class="memo-list" id="memoList">
      <div class="memo-item" id="mainItem" onclick="openPlayer()">
        <div class="memo-title-row">
          <span class="memo-name">엄마와 마지막 통화</span>
          <span class="memo-duration">3:47</span>
        </div>
        <div class="memo-meta">
          <span class="memo-date">2022. 11. 9.</span>
        </div>
      </div>
      <div class="memo-item" onclick="closePlayer()">
        <div class="memo-title-row">
          <span class="memo-name">새로운 녹음</span>
          <span class="memo-duration">0:23</span>
        </div>
        <div class="memo-meta">
          <span class="memo-date">오늘 오전 9:41</span>
        </div>
      </div>
      <div class="memo-item" onclick="closePlayer()">
        <div class="memo-title-row">
          <span class="memo-name">회의 메모</span>
          <span class="memo-duration">12:08</span>
        </div>
        <div class="memo-meta">
          <span class="memo-date">2022. 10. 28.</span>
        </div>
      </div>
      <div class="memo-item" onclick="closePlayer()">
        <div class="memo-title-row">
          <span class="memo-name">아이디어 메모</span>
          <span class="memo-duration">1:52</span>
        </div>
        <div class="memo-meta">
          <span class="memo-date">2022. 10. 15.</span>
        </div>
      </div>
      <div class="memo-item" onclick="closePlayer()">
        <div class="memo-title-row">
          <span class="memo-name">인터뷰 녹음</span>
          <span class="memo-duration">28:34</span>
        </div>
        <div class="memo-meta">
          <span class="memo-date">2022. 9. 3.</span>
        </div>
      </div>
    </div>

  </div>

  <!-- Bottom Record Bar -->
  <div class="bottom-bar">
    <div class="record-btn-outer">
      <div class="record-btn-inner"></div>
    </div>
  </div>

</div>

<script>
  // ── Waveform ──
  const waveformEl = document.getElementById('waveform');
  const barCount = 70;
  const heights = [];
  for (let i = 0; i < barCount; i++) {
    const v = 8 + Math.abs(Math.sin(i * 0.2) * Math.sin(i * 0.07)) * 44 + Math.random() * 8;
    heights.push(Math.max(4, v));
    const bar = document.createElement('div');
    bar.className = 'waveform-bar';
    bar.style.height = heights[i] + 'px';
    bar.id = 'bar' + i;
    waveformEl.appendChild(bar);
  }
  const ph = document.createElement('div');
  ph.className = 'playhead'; ph.id = 'playhead';
  waveformEl.appendChild(ph);

  // ── State ──
  let isPlaying = false;
  let currentTime = 0;
  const totalTime = 227;
  const speeds = [1, 1.5, 2, 0.5];
  let speedIdx = 0;
  let timer = null;

  function formatTime(s) {
    const m = Math.floor(s / 60), sec = Math.floor(s % 60);
    return m + ':' + (sec < 10 ? '0' : '') + sec;
  }

  function updateUI() {
    const progress = currentTime / totalTime;
    const playedBars = Math.floor(progress * barCount);
    for (let i = 0; i < barCount; i++) {
      document.getElementById('bar' + i).classList.toggle('played', i < playedBars);
    }
    document.getElementById('playhead').style.left = (progress * 100) + '%';
    document.getElementById('timeCurrent').textContent = formatTime(currentTime);
    const rem = totalTime - currentTime;
    document.querySelector('.time-total').textContent = '-' + formatTime(rem);
  }

  function togglePlay() {
    isPlaying = !isPlaying;
    const icon = document.getElementById('playIconEl');
    if (isPlaying) {
      icon.className = '';
      icon.innerHTML = '<div class="pause-icon"><span></span><span></span></div>';
      timer = setInterval(() => {
        currentTime += speeds[speedIdx];
        if (currentTime >= totalTime) {
          currentTime = totalTime; clearInterval(timer); isPlaying = false;
          icon.className = 'play-icon'; icon.innerHTML = '';
        }
        updateUI();
      }, 1000);
    } else {
      clearInterval(timer);
      icon.className = 'play-icon'; icon.innerHTML = '';
    }
  }

  function skip(s) {
    currentTime = Math.max(0, Math.min(totalTime, currentTime + s));
    updateUI();
  }

  function cycleSpeed() {
    speedIdx = (speedIdx + 1) % speeds.length;
    document.getElementById('speedLabel').textContent = speeds[speedIdx] + '×';
  }

  function seekWaveform(e) {
    const rect = waveformEl.getBoundingClientRect();
    const ratio = (e.clientX - rect.left) / rect.width;
    currentTime = Math.max(0, Math.min(totalTime, ratio * totalTime));
    updateUI();
  }

  function openPlayer() {
    const panel = document.getElementById('playerPanel');
    const mainItem = document.getElementById('mainItem');
    panel.classList.add('visible');
    mainItem.style.borderRadius = '0 0 12px 12px';
    panel.style.borderRadius = '12px 12px 0 0';
    updateUI();
    panel.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }

  function closePlayer() {
    const panel = document.getElementById('playerPanel');
    panel.classList.remove('visible');
    document.getElementById('mainItem').style.borderRadius = '';
    if (isPlaying) togglePlay();
  }

  // ── Service Worker ──
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js').catch(() => {});
  }

  // Auto open
  setTimeout(openPlayer, 500);
</script>
</body>
</html>
